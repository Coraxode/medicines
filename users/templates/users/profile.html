{% extends 'base.html' %}
{% load static %}

{% block content %}
<div class="user-info">
    <img src="{% if 'https%3A/' in user_info.photo.url %}{{ user_info.photo }}{% else %}{{ user_info.photo.url }}{% endif %}" alt="{{ user_info.username }}_photo" width="210" height="210"/>
    <h2 class='username-in-profile'>{{ user_info.username }}</h2>
    {% if user == user_info %}
    <form action="{% url 'user:profile' username=user_info.username %}" method="POST" enctype="multipart/form-data">
        {% csrf_token %}
        <label for="first_name">Ім'я:</label>
        <input type="text" id="first_name" style="left: 70px;" name="first_name" value="{% if form.first_name.value %}{{ form.first_name.value }}{% endif %}"><br>
        <label for="last_name">Прізвище:</label>
        <input type="text" id="last_name" style="left: 23px;" name="last_name" value="{% if form.last_name.value %}{{ form.last_name.value }}{% endif %}"><br>
        <label for="email">email:</label>
        <input type="text" id="email" style="left: 58px;" name="email" value="{% if form.email.value %}{{ form.email.value }}{% endif %}"><br>
        {% if form.email.errors %}
            {{ form.email.errors }}
        {% endif %}
        <label for="profile_photo">Фото профілю:</label>
        <input type="file" id="profile_photo" name="photo"><br>
        <input type="submit" value="Зберегти">
    </form>
    {% endif %}
</div>
<div class="user-favourites-info">
    <p>Вибране:</p>
    <div>
    {% for p in user_info.favourites.all %}
        <div class='medicine' onclick="location.href='{% url 'store:medicine_page' id=p.id %}';">
            <img src="{% if 'https%3A/' in p.photo.url %}{{ p.photo }}{% else %}{{ p.photo.url }}{% endif %}" alt="{{ p.name }}" width="175" height="175"/> <br>
            <label style='font-weight: 450;'>{{ p.name }}</label> <br><br>
            <label style='font-size: 17px; font-weight: 600;'>{{ p.price }} грн</label>
            {% if user.is_authenticated and user == user_info %}
                <div class="buy-favourites-buttons-block">
                    <form class="buy-from-mp-form">
                        <input class="buy-from-mp-button" type="button" onclick="alert('Не готово!'); event.stopPropagation();" value="В корзину">
                    </form>
                    <form action="{% url 'store:store' %}" class="add-to-favourites-mp-form">
                        <input type="hidden" name="username" value="{{ user.username }}">
                        <input type="hidden" name="medicine_id" value="{{ p.id }}">
                        <input type="hidden" name="url" value="{{ request.build_absolute_uri }}">
                        <input type="hidden" name="add_to_favourites" value=True>
                        <input id="add-to-favourites-mp-button-{{ p.id }}" class="add-to-favourites-mp-button" type="submit" onclick="event.stopPropagation();" value="До улюблених">
                    </form>
                </div>
            {% endif %}
        </div>
    {% endfor %}
    </div>
</div>
{% endblock %}